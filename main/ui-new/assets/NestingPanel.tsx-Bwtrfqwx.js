import{b as t,t as e,j as r,h as s,S as i,m as a,f as n,e as l,g as d,a as g,o,F as c,s as x,i as u}from"./chunk-CloFZg_W.js";import{u as f}from"./chunk-CxE4G7Dl.js";import{a as h,g as b}from"./chunk-DwRD3xX6.js";import{n as y,c as v,i as m}from"./chunk-BkE0-c49.js";import{e as p}from"./chunk-C5qu5Lxj.js";import{a as k}from"./chunk-u1_vX_6Z.js";import"./chunk-CJSr3jq0.js";var w=e('<div class="text-sm text-gray-600 dark:text-gray-400 text-center">: '),C=e('<div class="bg-gray-50 dark:bg-gray-700 p-3 rounded"><span class="text-sm font-medium text-gray-700 dark:text-gray-300">:</span><span class="ml-2 text-sm text-gray-900 dark:text-gray-100">'),S=e('<div class="grid grid-cols-2 gap-4 pt-4 border-t border-gray-200 dark:border-gray-600"><div class="flex justify-between"><span class="text-sm text-gray-600 dark:text-gray-400">:</span><span class="text-sm font-medium text-gray-900 dark:text-gray-100"></span></div><div class="flex justify-between"><span class="text-sm text-gray-600 dark:text-gray-400">:</span><span class="text-sm font-medium text-gray-900 dark:text-gray-100">'),_=e('<div class="p-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 m-4"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-medium text-gray-900 dark:text-gray-100"></h3><div class="text-2xl font-bold text-blue-600 dark:text-blue-400">%</div></div><div class=mb-6><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2 overflow-hidden"><div class="h-full bg-blue-500 dark:bg-blue-400 rounded-full transition-all duration-300 ease-out"></div></div></div><div class=space-y-4><div class="grid grid-cols-2 gap-4"><div class="flex justify-between"><span class="text-sm text-gray-600 dark:text-gray-400">:</span><span class="text-sm font-medium text-gray-900 dark:text-gray-100"></span></div><div class="flex justify-between"><span class="text-sm text-gray-600 dark:text-gray-400">:</span><span></span></div></div></div><div class="flex justify-center pt-4 border-t border-gray-200 dark:border-gray-600"><button class="text-blue-600 dark:text-blue-400 hover:underline text-sm">');const j=()=>{const[e]=f("nesting"),d=t(()=>Math.max(0,Math.min(100,h.process.progress))),g=t(()=>{const t=d();if(0===t)return null;const e=6e4*(100-t)/t;return e<6e4?`${Math.round(e/1e3)}s`:`${Math.round(e/6e4)}m`});return y=(b=(u=(x=(c=_()).firstChild).firstChild).nextSibling).firstChild,v=x.nextSibling,m=v.firstChild.firstChild,N=($=(j=(k=(p=v.nextSibling).firstChild).firstChild).firstChild).firstChild,F=$.nextSibling,P=(M=j.nextSibling.firstChild).firstChild,A=M.nextSibling,D=p.nextSibling.firstChild,r(u,()=>e("nesting_in_progress")),r(b,()=>d().toFixed(1),y),r(v,s(i,{get when(){return g()},get children(){var t=w(),s=t.firstChild;return r(t,()=>e("estimated_time_remaining"),s),r(t,g,null),t}}),null),r(p,s(i,{get when(){return h.process.workerStatus.currentOperation},get children(){var t=C(),s=t.firstChild,i=s.firstChild,a=s.nextSibling;return r(s,()=>e("current_operation"),i),r(a,()=>h.process.workerStatus.currentOperation),t}}),k),r($,()=>e("threads_active"),N),r(F,()=>h.process.workerStatus.threadsActive),r(M,()=>e("worker_status"),P),r(A,(o=a(()=>!!h.process.workerStatus.isRunning),()=>o()?e("running"):e("stopped"))),r(p,s(i,{get when(){return h.process.currentNest},get children(){var t=S(),s=t.firstChild,i=s.firstChild,a=i.firstChild,n=i.nextSibling,l=s.nextSibling.firstChild,d=l.firstChild,g=l.nextSibling;return r(i,()=>e("current_generation"),a),r(n,()=>h.process.currentNest?.generation||0),r(l,()=>e("best_fitness"),d),r(g,()=>h.process.currentNest?.fitness?.toFixed(2)||"N/A"),t}}),null),D.$$click=()=>window.location.reload(),r(D,()=>e("refresh_status")),n(t=>{var e=`${d()}%`,r="text-sm font-medium "+(h.process.workerStatus.isRunning?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400");return e!==t.e&&(null!=(t.e=e)?m.style.setProperty("width",e):m.style.removeProperty("width")),r!==t.t&&l(A,t.t=r),t},{e:void 0,t:void 0}),c;var o,c,x,u,b,y,v,m,p,k,j,$,N,F,M,P,A,D};d(["click"]);var $=e('<div class="text-sm text-gray-600 dark:text-gray-400">'),N=e('<div class="p-4 border-b border-gray-200 dark:border-gray-700"><h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"></h4><div class="grid grid-cols-2 gap-4"><div><span class="text-xs text-gray-500 dark:text-gray-400"></span><div class="font-mono text-sm text-gray-900 dark:text-gray-100"></div></div><div><span class="text-xs text-gray-500 dark:text-gray-400"></span><div class="font-mono text-sm text-gray-900 dark:text-gray-100">%'),F=e('<div class="space-y-2 max-h-64 overflow-y-auto">'),M=e('<div class=p-4><h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"> (<!>)'),P=e('<span class="text-xs text-red-600 dark:text-red-400">(<!>)'),A=e('<div class="p-4 bg-red-50 dark:bg-red-900/20 border-t border-red-200 dark:border-red-700"><div class="flex items-center space-x-2"><div class="w-2 h-2 rounded-full bg-red-500"></div><span class="text-sm text-red-700 dark:text-red-300">'),D=e('<div class="p-4 bg-red-50 dark:bg-red-900/20 border-t border-red-200 dark:border-red-700"><div class="flex items-start space-x-2"><div class="w-2 h-2 rounded-full bg-red-500 mt-1"></div><div><div class="text-sm font-medium text-red-700 dark:text-red-300"></div><div class="text-xs text-red-600 dark:text-red-400 mt-1">'),O=e('<div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 m-4"><div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700"><div class="flex items-center space-x-3"><h3 class="text-lg font-medium text-gray-900 dark:text-gray-100"></h3><div></div></div><div class="flex items-center space-x-2"><span class="text-sm text-gray-500 dark:text-gray-400">: </span><button class="text-blue-600 dark:text-blue-400 hover:underline text-sm"></button></div></div><div class="p-4 border-b border-gray-200 dark:border-gray-700"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-gray-700 dark:text-gray-300"></span><span class="text-sm font-bold text-blue-600 dark:text-blue-400">%</span></div><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-2"><div class="h-full bg-blue-500 dark:bg-blue-400 rounded-full transition-all duration-300">'),Z=e('<div class="text-sm text-gray-500 dark:text-gray-400 text-center py-4">'),z=e('<div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded"><div class="flex items-center space-x-3"><div class="w-2 h-2 rounded-full bg-blue-500"></div><span class="text-sm font-medium text-gray-700 dark:text-gray-300">#</span></div><div class="flex items-center space-x-4"><div class=text-right><div class="text-xs text-gray-500 dark:text-gray-400"></div><div class="font-mono text-sm text-gray-900 dark:text-gray-100"></div></div><div class=text-right><div class="text-xs text-gray-500 dark:text-gray-400"></div><div class="font-mono text-sm text-gray-900 dark:text-gray-100">%</div></div><div class=text-right><div class="text-xs text-gray-500 dark:text-gray-400"></div><div class="font-mono text-sm text-gray-900 dark:text-gray-100">');const R=()=>{const[t]=f("nesting"),[e,d]=g([]),[u,b]=g(Date.now()),[m,p]=g(!1),k=y.onBackgroundProgress(t=>{b(Date.now())}),w=y.onBackgroundResponse(t=>{d(e=>[t,...e].slice(0,10)),b(Date.now())});o(()=>{k?.(),w?.()});const C=t=>t.toFixed(4),S=t=>(100*t).toFixed(1);return V=(T=(R=(j=O()).firstChild).firstChild).firstChild,E=V.nextSibling,B=(U=T.nextSibling.firstChild).firstChild,I=U.nextSibling,L=(K=(G=(q=(W=R.nextSibling).firstChild).firstChild).nextSibling).firstChild,X=q.nextSibling.firstChild,r(V,()=>t("live_results")),r(U,()=>t("last_update"),B),r(U,()=>{const e=Date.now()-u();return e<1e3?t("just_now"):e<6e4?t("seconds_ago",{count:Math.floor(e/1e3)}):e<36e5?t("minutes_ago",{count:Math.floor(e/6e4)}):t("hours_ago",{count:Math.floor(e/36e5)})},null),I.$$click=()=>p(!m()),r(I,(_=a(()=>!!m()),()=>_()?t("collapse"):t("expand"))),r(G,()=>t("current_progress")),r(K,()=>(100*h.process.progress).toFixed(1),L),r(W,s(i,{get when(){return h.process.workerStatus.currentOperation},get children(){var t=$();return r(t,()=>h.process.workerStatus.currentOperation),t}}),null),r(j,s(i,{get when(){return h.process.currentNest},get children(){var e=N(),s=e.firstChild,i=s.nextSibling.firstChild,a=i.firstChild,n=a.nextSibling,l=i.nextSibling.firstChild,d=l.nextSibling,g=d.firstChild;return r(s,()=>t("best_result")),r(a,()=>t("fitness")),r(n,()=>C(h.process.currentNest.fitness)),r(l,()=>t("utilization")),r(d,()=>S(h.process.currentNest.utilisation),g),e}}),null),r(j,s(i,{get when(){return m()},get children(){var a=M(),n=a.firstChild,l=n.firstChild,d=l.nextSibling;return d.nextSibling,r(n,()=>t("intermediate_results"),l),r(n,()=>e().length,d),r(a,s(i,{get when(){return e().length>0},get fallback(){return e=Z(),r(e,()=>t("no_intermediate_results")),e;var e},get children(){var i=F();return r(i,s(c,{get each(){return e()},children:(e,s)=>(()=>{var s=z(),i=s.firstChild,a=i.firstChild.nextSibling;a.firstChild;var n=i.nextSibling.firstChild,l=n.firstChild,d=l.nextSibling,g=n.nextSibling,o=g.firstChild,c=o.nextSibling,x=c.firstChild,u=g.nextSibling.firstChild,f=u.nextSibling;return r(a,()=>e.index,null),r(l,()=>t("fitness")),r(d,()=>C(e.fitness)),r(o,()=>t("utilization")),r(c,()=>S(e.utilisation),x),r(u,()=>t("sheets")),r(f,()=>e.placements.length),s})()})),i}}),null),a}}),null),r(j,s(i,{get when(){return!v.status.connected},get children(){var e=A(),a=e.firstChild,n=a.firstChild.nextSibling;return r(n,()=>t("connection_lost")),r(a,s(i,{get when(){return v.status.reconnectAttempts>0},get children(){var e=P(),s=e.firstChild.nextSibling;return s.nextSibling,r(e,()=>t("reconnect_attempts",{count:v.status.reconnectAttempts}),s),e}}),null),e}}),null),r(j,s(i,{get when(){return h.process.lastError},get children(){var e=D(),s=e.firstChild.firstChild.nextSibling.firstChild,i=s.nextSibling;return r(s,()=>t("error_occurred")),r(i,()=>h.process.lastError),e}}),null),n(e=>{var r=`w-2 h-2 rounded-full ${(()=>{const t=v.status;return t.connected?t.healthy?"text-green-500":"text-yellow-500":"text-red-500"})()}`,s=v.status.connected?t("connected"):t("disconnected"),i=100*h.process.progress+"%";return r!==e.e&&l(E,e.e=r),s!==e.t&&x(E,"title",e.t=s),i!==e.a&&(null!=(e.a=i)?X.style.setProperty("width",i):X.style.removeProperty("width")),e},{e:void 0,t:void 0,a:void 0}),j;var _,j,R,T,V,E,U,B,I,W,q,G,K,L,X};d(["click"]);var T=e('<div class="flex justify-between text-sm"><span class="text-gray-600 dark:text-gray-400">:</span><span class="font-medium text-gray-900 dark:text-gray-100">ms'),V=e('<div class="flex justify-between text-sm"><span class="text-gray-600 dark:text-gray-400">:</span><span class="font-medium text-gray-900 dark:text-gray-100">'),E=e('<div class="h-full flex flex-col"><div class="flex-1 flex"><div class="flex-1 bg-white dark:bg-gray-900"><svg class="w-full h-96 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800"width=100% height=400 viewBox="0 0 800 400"><g><defs><pattern id=grid width=20 height=20 patternUnits=userSpaceOnUse><path d="M 20 0 L 0 0 0 20"fill=none stroke=#e0e0e0 stroke-width=1></path></pattern></defs><rect width=800 height=400 fill=url(#grid)></rect></g></svg></div><div class="w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 overflow-y-auto"><div class=p-4><h4 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4"></h4><div class="grid grid-cols-2 gap-3 mb-6"><div class="bg-gray-50 dark:bg-gray-700 p-3 rounded text-center"><div class="text-2xl font-bold text-green-600 dark:text-green-400"></div><div class="text-xs text-gray-600 dark:text-gray-400 mt-1"></div></div><div class="bg-gray-50 dark:bg-gray-700 p-3 rounded text-center"><div class="text-2xl font-bold text-gray-900 dark:text-gray-100"></div><div class="text-xs text-gray-600 dark:text-gray-400 mt-1"></div></div><div class="bg-gray-50 dark:bg-gray-700 p-3 rounded text-center"><div class="text-2xl font-bold text-gray-900 dark:text-gray-100"></div><div class="text-xs text-gray-600 dark:text-gray-400 mt-1"></div></div><div class="bg-gray-50 dark:bg-gray-700 p-3 rounded text-center"><div class="text-2xl font-bold text-red-600 dark:text-red-400">%</div><div class="text-xs text-gray-600 dark:text-gray-400 mt-1"></div></div></div><div class=space-y-3><div class="flex justify-between text-sm"><span class="text-gray-600 dark:text-gray-400">:</span><span class="font-medium text-gray-900 dark:text-gray-100"></span></div><div class="flex justify-between text-sm"><span class="text-gray-600 dark:text-gray-400">:</span><span class="font-medium text-gray-900 dark:text-gray-100">'),U=e('<svg><g class=sheet-group><rect fill="rgba(200, 200, 200, 0.3)"stroke=#e5e7eb stroke-width=2></rect><text font-size=12 fill=#6b7280> </svg>',!1,!0,!1),B=e('<svg><g class=part-group><rect fill="rgba(59, 130, 246, 0.7)"stroke=#3b82f6 stroke-width=1></svg>',!1,!0,!1);const I=e=>{const[l]=f("nesting"),d=p({initialZoom:1,bounds:{minZoom:.1,maxZoom:10},enableKeyboardShortcuts:!0,enableWheelZoom:!0,enablePan:!0}),g=t(()=>e.result.sheets?.reduce((t,e)=>t+e.width*e.height,0)||0),o=t(()=>e.result.placedParts||0),h=t(()=>{const t=g(),e=o();return 0===t?0:(t-e)/t*100}),b=t(()=>{const t=e.result.sheets||[];if(0===t.length)return{width:800,height:400,x:0,y:0};let r=1/0,s=1/0,i=-1/0,a=-1/0;return t.forEach(t=>{const e=t.x||0,n=t.y||0;r=Math.min(r,e),s=Math.min(s,n),i=Math.max(i,e+t.width),a=Math.max(a,n+t.height)}),{x:r,y:s,width:i-r,height:a-s}}),y=()=>{d.zoomToFit(b())};return(()=>{var t=E(),o=t.firstChild,f=o.firstChild,b=f.firstChild,v=b.firstChild;v.firstChild.nextSibling;var m,p=f.nextSibling.firstChild.firstChild,w=p.nextSibling,C=w.firstChild,S=C.firstChild,_=S.nextSibling,j=C.nextSibling,$=j.firstChild,N=$.nextSibling,F=j.nextSibling,M=F.firstChild,P=M.nextSibling,A=F.nextSibling.firstChild,D=A.firstChild,O=A.nextSibling,Z=w.nextSibling,z=Z.firstChild,R=z.firstChild,I=R.firstChild,W=R.nextSibling,q=z.nextSibling.firstChild,G=q.firstChild,K=q.nextSibling;return r(t,s(k,{get viewportState(){return d.viewportState()},get onZoomIn(){return d.zoomIn},get onZoomOut(){return d.zoomOut},onZoomToFit:y,get onResetView(){return d.resetView},get onCenterView(){return d.centerView},showFitToContent:!0,showPanControls:!0}),o),u(b,"wheel",d.handleWheel),u(b,"mouseleave",d.handleMouseUp),u(b,"mouseup",d.handleMouseUp,!0),u(b,"mousemove",d.handleMouseMove,!0),u(b,"mousedown",d.handleMouseDown,!0),r(v,s(c,{get each(){return e.result.sheets||[]},children:(t,e)=>{return s=U(),i=s.firstChild,d=(a=i.nextSibling).firstChild,r(a,()=>l("sheet"),d),r(a,()=>e()+1,null),n(e=>{var r=t.x||0,s=t.y||0,n=t.width,l=t.height,d=(t.x||0)+10,g=(t.y||0)+25;return r!==e.e&&x(i,"x",e.e=r),s!==e.t&&x(i,"y",e.t=s),n!==e.a&&x(i,"width",e.a=n),l!==e.o&&x(i,"height",e.o=l),d!==e.i&&x(a,"x",e.i=d),g!==e.n&&x(a,"y",e.n=g),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),s;var s,i,a,d}}),null),r(v,s(c,{get each(){return e.result.placements||[]},children:t=>{return e=B(),r=e.firstChild,n(e=>{var s=t.x,i=t.y,a=t.width||50,n=t.height||50,l=`rotate(${t.rotation||0} ${t.x+(t.width||50)/2} ${t.y+(t.height||50)/2})`;return s!==e.e&&x(r,"x",e.e=s),i!==e.t&&x(r,"y",e.t=i),a!==e.a&&x(r,"width",e.a=a),n!==e.o&&x(r,"height",e.o=n),l!==e.i&&x(r,"transform",e.i=l),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),e;var e,r}}),null),r(p,()=>l("statistics")),r(S,(m=a(()=>!!e.result.efficiency),()=>m()?`${(100*e.result.efficiency).toFixed(1)}%`:"N/A")),r(_,()=>l("material_efficiency")),r($,()=>e.result.fitness?.toFixed(2)||"N/A"),r(N,()=>l("fitness_score")),r(M,()=>e.result.sheets?.length||0),r(P,()=>l("sheets_used")),r(A,()=>h().toFixed(1),D),r(O,()=>l("material_waste")),r(R,()=>l("total_parts_placed"),I),r(W,()=>e.result.placedParts||0),r(q,()=>l("total_material_used"),G),r(K,()=>g().toFixed(2)),r(Z,s(i,{get when(){return e.result.generationTime},get children(){var t=T(),s=t.firstChild,i=s.firstChild,a=s.nextSibling,n=a.firstChild;return r(s,()=>l("generation_time"),i),r(a,()=>e.result.generationTime,n),t}}),null),r(Z,s(i,{get when(){return e.result.generation},get children(){var t=V(),s=t.firstChild,i=s.firstChild,a=s.nextSibling;return r(s,()=>l("generation_number"),i),r(a,()=>e.result.generation),t}}),null),n(t=>{var e=d.cursor(),r=d.transform();return e!==t.e&&(null!=(t.e=e)?b.style.setProperty("cursor",e):b.style.removeProperty("cursor")),r!==t.t&&x(v,"transform",t.t=r),t},{e:void 0,t:void 0}),t})()};d(["mousedown","mousemove","mouseup"]);var W=e('<div class="h-full flex flex-col"><div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"><button class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200">← </button><h3 class="text-lg font-medium text-gray-900 dark:text-gray-100"></h3><div class="flex gap-2"><button class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200">📤 '),q=e('<div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"><h3 class="text-lg font-medium text-gray-900 dark:text-gray-100"> (<!>)</h3><div class="text-sm text-gray-600 dark:text-gray-400"><label>'),G=e('<div class="flex-1 overflow-y-auto p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">'),K=e('<div class="h-full flex flex-col">'),L=e('<span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">'),X=e('<div class="flex justify-between text-sm"><span class="text-gray-600 dark:text-gray-400">:</span><span class="font-medium text-gray-900 dark:text-gray-100">'),H=e('<div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-lg transition-shadow duration-200"><div class="h-32 bg-gray-50 dark:bg-gray-700 flex items-center justify-center cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors"><div class=text-center><div class="text-2xl mb-1">🎯</div><div class="text-sm text-gray-600 dark:text-gray-400"></div></div></div><div class=p-4><div class="flex items-center justify-between mb-3"><h4 class="font-medium text-gray-900 dark:text-gray-100"> #</h4></div><div class="space-y-2 mb-4"><div class="flex justify-between text-sm"><span class="text-gray-600 dark:text-gray-400">:</span><span class="font-medium text-green-600 dark:text-green-400"></span></div><div class="flex justify-between text-sm"><span class="text-gray-600 dark:text-gray-400">:</span><span class="font-medium text-gray-900 dark:text-gray-100"></span></div><div class="flex justify-between text-sm"><span class="text-gray-600 dark:text-gray-400">:</span><span class="font-medium text-gray-900 dark:text-gray-100"></span></div></div><div class="flex justify-between items-center pt-2 border-t border-gray-200 dark:border-gray-700"><button class="text-blue-600 dark:text-blue-400 hover:underline text-sm"></button><div class="flex gap-2"><button class="text-blue-600 dark:text-blue-400 hover:underline text-sm"></button><button class="text-red-600 dark:text-red-400 hover:underline text-sm">');const J=()=>{const[e]=f("nesting"),[n,l]=g(null),[d,o]=g("grid"),x=t(()=>[...h.app.nests].sort((t,e)=>t.efficiency!==e.efficiency?(e.efficiency||0)-(t.efficiency||0):(e.fitness||0)-(t.fitness||0))),u=t=>{l(t),o("detail")},y=()=>{l(null),o("grid")},v=async t=>{if(m.isAvailable)try{const r=await m.saveFileDialog({title:e("export_result"),defaultPath:`nest_result_${t.id}.svg`,filters:[{name:"SVG Files",extensions:["svg"]},{name:"DXF Files",extensions:["dxf"]},{name:"All Files",extensions:["*"]}]});if(r.canceled||!r.filePath)return;await m.exportNestResult(t,r.filePath)}catch(r){b.setError(e("export_failed"))}};return p=K(),r(p,s(i,{get when(){return a(()=>"detail"===d())()&&n()},get children(){var t=W(),i=t.firstChild.firstChild;i.firstChild;var a=i.nextSibling,l=a.nextSibling.firstChild;return l.firstChild,i.$$click=y,r(i,()=>e("back_to_results"),null),r(a,()=>e("result_details")),l.$$click=()=>v(n()),r(l,()=>e("export"),null),r(t,s(I,{get result(){return n()}}),null),t}}),null),r(p,s(i,{get when(){return"grid"===d()},get children(){return[(()=>{var t=q(),s=t.firstChild,i=s.firstChild,a=i.nextSibling;a.nextSibling;var n=s.nextSibling.firstChild;return r(s,()=>e("nesting_results"),i),r(s,()=>x().length,a),r(n,()=>e("sorted_by_efficiency")),t})(),(t=G(),r(t,s(c,{get each(){return x()},children:(t,a)=>{return d=(l=(n=H()).firstChild).firstChild.firstChild.nextSibling,c=(o=(g=l.nextSibling.firstChild).firstChild).firstChild,m=(y=(f=(x=g.nextSibling).firstChild).firstChild).firstChild,p=y.nextSibling,C=(w=(k=f.nextSibling).firstChild).firstChild,S=w.nextSibling,j=(_=k.nextSibling.firstChild).firstChild,$=_.nextSibling,M=(F=(N=x.nextSibling.firstChild).nextSibling.firstChild).nextSibling,l.$$click=()=>u(t),r(d,()=>e("click_to_view")),r(o,()=>e("result"),c),r(o,()=>a()+1,null),r(g,s(i,{get when(){return 0===a()},get children(){var t=L();return r(t,()=>e("best")),t}}),null),r(y,()=>e("efficiency"),m),r(p,()=>{return(e=t.efficiency)?`${(100*e).toFixed(1)}%`:"N/A";var e}),r(w,()=>e("fitness"),C),r(S,()=>{return(e=t.fitness)?e.toFixed(2):"N/A";var e}),r(_,()=>e("sheets_used"),j),r($,()=>t.sheets?.length||0),r(x,s(i,{get when(){return t.placedParts},get children(){var s=X(),i=s.firstChild,a=i.firstChild,n=i.nextSibling;return r(i,()=>e("parts_placed"),a),r(n,()=>t.placedParts),s}}),null),N.$$click=()=>u(t),r(N,()=>e("view_details")),F.$$click=()=>v(t),r(F,()=>e("export")),M.$$click=()=>(t=>{const e=h.app.nests.filter(e=>e.id!==t.id);b.setNests(e)})(t),r(M,()=>e("delete")),n;var n,l,d,g,o,c,x,f,y,m,p,k,w,C,S,_,j,$,N,F,M}})),t)];var t}}),null),p;var p};d(["click"]);var Q=e('<button class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200">🗑️ '),Y=e('<div class="grid grid-cols-1 lg:grid-cols-2 gap-4 p-4">'),tt=e('<div class="h-full flex flex-col"><div class="flex items-center justify-between p-5 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"><h2 class="text-lg font-medium text-gray-900 dark:text-gray-100"></h2><div class="flex gap-2"><button class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200">▶️ </button><button class="inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200">⏹️ </button></div></div><div class="flex items-center justify-between p-4 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"><div class="flex gap-6"><div class="flex items-center gap-2"><span class="text-sm text-gray-600 dark:text-gray-400">:</span><span class="text-sm font-medium text-gray-900 dark:text-gray-100"></span></div><div class="flex items-center gap-2"><span class="text-sm text-gray-600 dark:text-gray-400">:</span><span class="text-sm font-medium text-gray-900 dark:text-gray-100"></span></div><div class="flex items-center gap-2"><span class="text-sm text-gray-600 dark:text-gray-400">:</span><span class="text-sm font-medium text-gray-900 dark:text-gray-100"></span></div></div></div><div class="flex-1 overflow-hidden">'),et=e('<p class="text-amber-600 dark:text-amber-400">'),rt=e('<div class="h-full flex flex-col items-center justify-center text-center gap-4 p-8"><div class="text-6xl opacity-30">🎯</div><h3 class="text-lg font-medium text-gray-900 dark:text-gray-100"></h3><p class="text-gray-600 dark:text-gray-400">');const st=()=>{const[e]=f("nesting"),a=t(()=>h.app.parts.length>0&&h.app.sheets.length>0&&!h.process.isNesting),l=t(()=>h.app.nests.length>0),d=async()=>{if(a())try{await y.startNesting()}catch(t){}},g=async()=>{if(h.process.isNesting)try{await y.stopNesting()}catch(t){}},o=()=>{b.setNests([])},c=t(()=>h.app.parts.filter(t=>t.quantity>0).length);return(()=>{var t=tt(),u=t.firstChild,f=u.firstChild,b=f.nextSibling,y=b.firstChild;y.firstChild;var v=y.nextSibling;v.firstChild;var m=u.nextSibling,p=m.firstChild.firstChild,k=p.firstChild,w=k.firstChild,C=k.nextSibling,S=p.nextSibling,_=S.firstChild,$=_.firstChild,N=_.nextSibling,F=S.nextSibling.firstChild,M=F.firstChild,P=F.nextSibling,A=m.nextSibling;return r(f,()=>e("nesting_title")),y.$$click=d,r(y,()=>e("start_nesting"),null),v.$$click=g,r(v,()=>e("stop_nesting"),null),r(b,s(i,{get when(){return l()&&!h.process.isNesting},get children(){var t=Q();return t.firstChild,t.$$click=o,r(t,()=>e("clear_results"),null),n(()=>x(t,"title",e("clear_results"))),t}}),null),r(k,()=>e("parts_to_nest"),w),r(C,c),r(_,()=>e("available_sheets"),$),r(N,()=>h.app.sheets.length),r(F,()=>e("results_count"),M),r(P,()=>h.app.nests.length),r(A,s(i,{get when(){return h.process.isNesting},get children(){var t=Y();return r(t,s(j,{}),null),r(t,s(R,{}),null),t}}),null),r(A,s(i,{get when(){return l()},get fallback(){return l=(n=(t=rt()).firstChild.nextSibling).nextSibling,r(n,()=>e("no_nesting_results")),r(l,()=>e("start_nesting_to_see_results")),r(t,s(i,{get when(){return!a()},get children(){var t=et();return r(t,()=>e("add_parts_and_sheets_first")),t}}),null),t;var t,n,l},get children(){return s(J,{})}}),null),n(t=>{var r=!a(),s=a()?e("start_nesting"):e("cannot_start_nesting"),i=!h.process.isNesting,n=e("stop_nesting");return r!==t.e&&(y.disabled=t.e=r),s!==t.t&&x(y,"title",t.t=s),i!==t.a&&(v.disabled=t.a=i),n!==t.o&&x(v,"title",t.o=n),t},{e:void 0,t:void 0,a:void 0,o:void 0}),t})()};d(["click"]);export{st as default};
