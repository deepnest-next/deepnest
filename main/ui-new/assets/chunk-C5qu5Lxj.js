import{c as e,o as t,a as n,b as o}from"./chunk-CloFZg_W.js";import{c as l,a}from"./chunk-CxE4G7Dl.js";const r={enabled:!0,context:"global"},s=(n,o={})=>{const l={...r,...o},a=e=>{if(!l.enabled)return;const t=e.target;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return;const o=n.find(t=>{const n=t.key.toLowerCase()===e.key.toLowerCase(),o=!!t.ctrlKey===e.ctrlKey,l=!!t.altKey===e.altKey,a=!!t.shiftKey===e.shiftKey,r=!!t.metaKey===e.metaKey;return n&&o&&l&&a&&r});o&&(!1!==o.preventDefault&&e.preventDefault(),o.action())};return e(()=>{l.enabled&&(document.addEventListener("keydown",a),t(()=>{document.removeEventListener("keydown",a)}))}),{shortcuts:n,enabled:()=>l.enabled}},c=(e,t,n,o={})=>({key:e,action:t,description:n,ctrlKey:o.ctrl,altKey:o.alt,shiftKey:o.shift,metaKey:o.meta}),i=e=>{const t=[];return e.ctrlKey&&t.push("Ctrl"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift"),e.metaKey&&t.push("Cmd"),t.push(e.key.toUpperCase()),t.join(" + ")},d={enableMultiSelect:!0,enableKeyboardShortcuts:!0,enableRangeSelect:!0,selectAllKey:"KeyA",deselectAllKey:"Escape"},u=(e,l={})=>{const a={...d,...l},[r,s]=n(new Set),[c,i]=n(null),[u,m]=n("single"),h=o(()=>{const t=r();return e().filter(e=>t.has(e.id))}),y=o(()=>r().size),f=o(()=>{const t=e(),n=r();return t.length>0&&t.every(e=>n.has(e.id))}),p=o(()=>0===r().size),g=o(()=>{const t=y();return t>0&&t<e().length}),b=e=>{s(t=>new Set([...t,e])),i(e)},w=e=>{s(t=>{const n=new Set(t);return n.delete(e),n}),c()===e&&i(null)},x=e=>{r().has(e)?w(e):b(e)},S=()=>{const t=e().map(e=>e.id);s(new Set(t)),i(t[t.length-1]||null)},v=()=>{s(new Set),i(null)},K=(t,n)=>{const o=e(),l=o.findIndex(e=>e.id===t),a=o.findIndex(e=>e.id===n);if(-1===l||-1===a)return;const r=Math.min(l,a),c=Math.max(l,a),d=o.slice(r,c+1).map(e=>e.id);s(e=>new Set([...e,...d])),i(n)},M=()=>{const t=e(),n=r(),o=new Set(t.filter(e=>!n.has(e.id)).map(e=>e.id));s(o),i(null)},k=e=>{if(!a.enableKeyboardShortcuts)return;const t=e.ctrlKey||e.metaKey,n=e.shiftKey;t&&e.code===a.selectAllKey?(e.preventDefault(),S()):e.code===a.deselectAllKey?(e.preventDefault(),v()):t&&"KeyI"===e.code?(e.preventDefault(),M()):"ArrowUp"!==e.code&&"ArrowDown"!==e.code||(e.preventDefault(),D("ArrowDown"===e.code?1:-1,n))},D=(t,n=!1)=>{const o=e();if(0===o.length)return;const l=c();let r,d=l?o.findIndex(e=>e.id===l):-1;if(-1===d){const e=o[t>0?0:o.length-1];return void(e&&b(e.id))}r=t>0?d>=o.length-1?0:d+1:d<=0?o.length-1:d-1;const u=o[r];u&&(n&&a.enableRangeSelect?K(l,u.id):(s(new Set([u.id])),i(u.id)))};return a.enableKeyboardShortcuts&&(document.addEventListener("keydown",k),t(()=>{document.removeEventListener("keydown",k)})),{selectedIds:r,selectedItems:h,selectedCount:y,isAllSelected:f,isNoneSelected:p,isPartiallySelected:g,lastSelectedId:c,selectionMode:u,selectItem:b,deselectItem:w,toggleItem:x,selectAll:S,deselectAll:v,selectRange:K,invertSelection:M,navigateSelection:D,handleItemClick:(e,t)=>{if(a.enableMultiSelect)if(t.ctrlKey||t.metaKey)m("multi"),x(e);else if(t.shiftKey&&a.enableRangeSelect){m("range");const t=c();t?K(t,e):b(e)}else m("single"),s(new Set([e])),i(e);else r().has(e)?v():(s(new Set([e])),i(e))},isSelected:e=>r().has(e),getSelectionInfo:()=>({selectedIds:Array.from(r()),selectedItems:h(),selectedCount:y(),isAllSelected:f(),isNoneSelected:p(),isPartiallySelected:g(),lastSelectedId:c(),selectionMode:u()})}},m={preventDefault:!0,closeOnClick:!0,closeOnScroll:!0,closeOnResize:!0},h=(t={})=>{const o={...m,...t},[a,r]=n(!1),[s,c]=n({x:0,y:0}),[i,d]=n([]),[u,h]=n(null),y=e=>{if(a()&&o.closeOnClick){const t=e.target,n=document.querySelector("[data-context-menu]");n&&!n.contains(t)&&w()}},f=()=>{a()&&o.closeOnScroll&&w()},p=()=>{a()&&o.closeOnResize&&w()},g=e=>{"Escape"===e.key&&a()&&(e.preventDefault(),w())};e(()=>{a()&&(l(document,"click",y),l(document,"scroll",f),l(document,"keydown",g),l(window,"resize",p))});const b=(e,t)=>{o.preventDefault&&e.preventDefault(),e.stopPropagation(),document.documentElement.getBoundingClientRect();const n=32*t.length;let l=e.clientX,a=e.clientY;l+200>window.innerWidth&&(l=window.innerWidth-200-10),a+n>window.innerHeight&&(a=window.innerHeight-n-10),c({x:l,y:a}),d(t),h(e.currentTarget),r(!0)},w=()=>{r(!1),d([]),h(null)};return{isOpen:a,position:s,menuItems:i,targetElement:u,openMenu:b,closeMenu:w,handleItemClick:e=>{e.disabled||e.submenu||(e.action(),w())},createContextMenuHandler:e=>t=>{const n=e(t);n.length>0&&b(t,n)},createMenuItem:(e,t,n,o={})=>({id:e,label:t,action:n,...o}),createSeparator:()=>({id:"separator",label:"",action:()=>{},separator:!0})}};function y(e){const{items:t,itemHeight:l,containerHeight:r,overscan:s=3}=e,[c,i]=n(0),[d,u]=n(!1),m=o(()=>t().length*l),h=o(()=>{const e=Math.floor(c()/l)-s;return Math.max(0,e)}),y=o(()=>{const e=Math.ceil((c()+r)/l)+s;return Math.min(t().length-1,e)}),f=o(()=>{const e=h(),n=y(),o=t(),a=[];for(let t=e;t<=n&&t<o.length;t++)a.push({item:o[t],index:t,offset:t*l});return a}),p=a(()=>{u(!1)},150);return{visibleItems:f,totalHeight:m,scrollTop:c,setScrollTop:i,startIndex:h,endIndex:y,handleScroll:e=>{const t=e.target;i(t.scrollTop),u(!0),p()},scrollToIndex:(e,n="start")=>{const o=t().length-1,a=Math.max(0,Math.min(e,o));let s;switch(n){case"center":s=a*l-r/2+l/2;break;case"end":s=a*l-r+l;break;default:s=a*l}const c=m()-r;s=Math.max(0,Math.min(s,c)),i(s);const d=document.querySelector("[data-virtual-scroll-container]");d&&(d.scrollTop=s)}}}const f={initialZoom:1,initialPan:{x:0,y:0},bounds:{minZoom:.1,maxZoom:10},zoomStep:1.2,enableKeyboardShortcuts:!0,enableWheelZoom:!0,enablePan:!0},p=(e={})=>{const l={...f,...e},[a,r]=n(l.initialZoom),[s,c]=n(l.initialPan),[i,d]=n(!1),[u,m]=n({x:0,y:0}),[h,y]=n({x:0,y:0}),p=o(()=>{const e=a(),t=s();return`translate(${t.x}, ${t.y}) scale(${e})`}),g=o(()=>({zoom:a(),pan:s(),isDragging:i()})),b=e=>Math.max(l.bounds.minZoom,Math.min(l.bounds.maxZoom,e)),w=e=>{if(!l.bounds.panBounds)return e;const t=l.bounds.panBounds;return{x:Math.max(t.minX,Math.min(t.maxX,e.x)),y:Math.max(t.minY,Math.min(t.maxY,e.y))}},x=(e=l.zoomStep)=>{r(t=>b(t*e))},S=(e=l.zoomStep)=>{r(t=>b(t/e))},v=e=>{c(w(e))},K=e=>{const t=s();v({x:t.x+e.x,y:t.y+e.y})},M=()=>{r(l.initialZoom),c(l.initialPan),d(!1)},k=e=>{if(l.enableKeyboardShortcuts&&!(e.ctrlKey||e.metaKey||e.altKey))switch(e.key){case"+":case"=":e.preventDefault(),x();break;case"-":e.preventDefault(),S();break;case"0":e.preventDefault(),M();break;case"ArrowUp":e.preventDefault(),K({x:0,y:50});break;case"ArrowDown":e.preventDefault(),K({x:0,y:-50});break;case"ArrowLeft":e.preventDefault(),K({x:50,y:0});break;case"ArrowRight":e.preventDefault(),K({x:-50,y:0})}};return l.enableKeyboardShortcuts&&(document.addEventListener("keydown",k),t(()=>{document.removeEventListener("keydown",k)})),{zoom:a,pan:s,isDragging:i,transform:p,viewportState:g,zoomIn:x,zoomOut:S,zoomTo:e=>{r(b(e))},zoomToFit:e=>{const t=800/e.width,n=600/e.height,o=.9*Math.min(t,n);if(r(b(o)),void 0!==e.x&&void 0!==e.y){const t=400-(e.x+e.width/2)*o,n=300-(e.y+e.height/2)*o;c(w({x:t,y:n}))}},panTo:v,panBy:K,centerView:()=>{c({x:0,y:0})},resetView:M,handleMouseDown:e=>{if(!l.enablePan)return;e.preventDefault(),d(!0);const t=s();m({x:e.clientX,y:e.clientY}),y(t)},handleMouseMove:e=>{if(!i()||!l.enablePan)return;e.preventDefault();const t=u(),n=h(),o={x:n.x+(e.clientX-t.x),y:n.y+(e.clientY-t.y)};c(w(o))},handleMouseUp:e=>{i()&&(e.preventDefault(),d(!1))},handleWheel:e=>{if(!l.enableWheelZoom)return;e.preventDefault();const t=e.deltaY>0?1/l.zoomStep:l.zoomStep,n=e.target.getBoundingClientRect(),o=e.clientX-n.left,i=e.clientY-n.top,d=a(),u=s(),m=b(d*t);if(m!==d){const e=m/d,t={x:o-(o-u.x)*e,y:i-(i-u.y)*e};r(m),c(w(t))}},cursor:o(()=>i()?"grabbing":"grab")}};export{s as a,h as b,c,u as d,p as e,i as f,y as u};
