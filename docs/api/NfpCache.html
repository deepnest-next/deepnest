<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: NfpCache</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: NfpCache</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>NfpCache<span class="signature">()</span><span class="type-signature"></span></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    

    
    <h4 class="name" id="NfpCache"><span class="type-signature"></span>new NfpCache<span class="signature">()</span><span class="type-signature"></span></h4>
    

    
    <p class="summary">High-performance in-memory cache for No-Fit Polygon (NFP) calculations.</p>
    



<div class="description">
    <p>High-performance in-memory cache for No-Fit Polygon (NFP) calculations.</p>
<p>Critical performance optimization component that stores computed NFPs to avoid
expensive recalculation during nesting operations. Uses a sophisticated keying
system based on polygon identifiers, rotations, and flip states to ensure
cache hits for identical geometric configurations.</p>
</div>













<dl class="details">

    

    
    <dt class="tag-since">Since:</dt>
    <dd class="tag-since"><ul class="dummy"><li>1.5.6</li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="build_nfpDb.js.html">build/nfpDb.js</a>, <a href="build_nfpDb.js.html#line2">line 2</a>
    </li></ul></dd>
    

    

    

    
</dl>



















    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// Basic cache usage
const cache = new NfpCache();
const nfpDoc: NfpDoc = {
  A: "container_1", B: "part_1",
  Arotation: 0, Brotation: 90,
  nfp: computedNfp
};
cache.insert(nfpDoc);</code></pre>

    <pre class="prettyprint"><code>// Cache lookup during nesting
const lookupDoc: NfpDoc = {
  A: "container_1", B: "part_1",
  Arotation: 0, Brotation: 90
};
const cachedNfp = cache.find(lookupDoc);
if (cachedNfp) {
  // Use cached result instead of expensive calculation
  processNfp(cachedNfp);
}</code></pre>



    
    </div>

    

    

    

    

    

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="db"><span class="type-signature"></span>db<span class="type-signature"></span></h4>


<p class="summary">Internal hash map storing NFPs by composite key.</p>



<div class="description">
    <p>Internal hash map storing NFPs by composite key.
Key format: &quot;A-B-Arot-Brot-Aflip-Bflip&quot;</p>
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="build_nfpDb.js.html">build/nfpDb.js</a>, <a href="build_nfpDb.js.html#line65">line 65</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="find"><span class="type-signature"></span>find<span class="signature">(obj, inner<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Nfp|Array.&lt;Nfp>|null}</span></h4>
    

    
    <p class="summary">Retrieves a cached NFP result with deep cloning for mutation safety.</p>
    



<div class="description">
    <p>Retrieves a cached NFP result with deep cloning for mutation safety.</p>
<p>Primary cache retrieval method that returns a deep copy of stored NFP data
to prevent external modification of cached results. Handles both single NFPs
and arrays of NFPs depending on the geometric calculation complexity.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>obj</code></td>
            

            <td class="type">
            
                
<span class="param-type">NfpDoc</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>NFP document specifying the calculation to retrieve</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>inner</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Whether to expect array of NFPs vs single NFP</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    
    <dt class="tag-since">Since:</dt>
    <dd class="tag-since"><ul class="dummy"><li>1.5.6</li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="build_nfpDb.js.html">build/nfpDb.js</a>, <a href="build_nfpDb.js.html#line356">line 356</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li>cloneNfp for cloning implementation details</li>
        
            <li>has for existence checking without cloning overhead</li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Cloned NFP result or null if not cached</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Nfp</span>
|

<span class="param-type">Array.&lt;Nfp></span>
|

<span class="param-type">null</span>


    </dd>
</dl>

    




    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// Basic cache retrieval
const nfpDoc: NfpDoc = {
  A: "container_1", B: "part_1",
  Arotation: 0, Brotation: 90
};
const cachedNfp = cache.find(nfpDoc);
if (cachedNfp) {
  // Safe to modify - this is a deep copy
  processNfp(cachedNfp);
}</code></pre>

    <pre class="prettyprint"><code>// Retrieving multiple NFPs
const complexNfpDoc: NfpDoc = {
  A: "complex_container", B: "complex_part",
  Arotation: 45, Brotation: 180
};
const nfpArray = cache.find(complexNfpDoc, true);
if (nfpArray &amp;&amp; Array.isArray(nfpArray)) {
  nfpArray.forEach(nfp => processIndividualNfp(nfp));
}</code></pre>



        
            

    

    
    <h4 class="name" id="getCache"><span class="type-signature"></span>getCache<span class="signature">()</span><span class="type-signature"> &rarr; {Record.&lt;string, (Nfp|Array.&lt;Nfp>)>}</span></h4>
    

    
    <p class="summary">Returns direct reference to internal cache storage for advanced operations.</p>
    



<div class="description">
    <p>Returns direct reference to internal cache storage for advanced operations.</p>
<p>Provides low-level access to the internal hash map for debugging, serialization,
or advanced cache management operations. Use with caution as direct modifications
can compromise cache integrity and defeat the deep cloning safety mechanisms.</p>
</div>













<dl class="details">

    

    
    <dt class="tag-since">Since:</dt>
    <dd class="tag-since"><ul class="dummy"><li>1.5.6</li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="build_nfpDb.js.html">build/nfpDb.js</a>, <a href="build_nfpDb.js.html#line514">line 514</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Direct reference to internal cache storage</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Record.&lt;string, (Nfp|Array.&lt;Nfp>)></span>


    </dd>
</dl>

    




    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// Debug cache contents
const cache = new NfpCache();
const cacheData = cache.getCache();
console.log("Cache keys:", Object.keys(cacheData));
console.log("Total cached NFPs:", Object.keys(cacheData).length);</code></pre>

    <pre class="prettyprint"><code>// Inspect specific cached NFP (read-only recommended)
const cacheData = cache.getCache();
const key = "container_1-part_1-0-90-0-0";
if (cacheData[key]) {
  console.log("NFP points:", cacheData[key].length);
}</code></pre>



        
            

    

    
    <h4 class="name" id="getStats"><span class="type-signature"></span>getStats<span class="signature">()</span><span class="type-signature"> &rarr; {number}</span></h4>
    

    
    <p class="summary">Returns the number of cached NFP calculations for performance monitoring.</p>
    



<div class="description">
    <p>Returns the number of cached NFP calculations for performance monitoring.</p>
<p>Simple statistics method that provides cache size information for monitoring
cache effectiveness, memory usage estimation, and performance optimization.
Essential for understanding cache hit rates and storage efficiency.</p>
</div>













<dl class="details">

    

    
    <dt class="tag-since">Since:</dt>
    <dd class="tag-since"><ul class="dummy"><li>1.5.6</li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="build_nfpDb.js.html">build/nfpDb.js</a>, <a href="build_nfpDb.js.html#line593">line 593</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li>getCache for detailed cache contents inspection</li>
        
            <li>has for individual entry existence checking</li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Total number of cached NFP calculations</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>

    




    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// Monitor cache growth during nesting
const cache = new NfpCache();
console.log("Initial cache size:", cache.getStats()); // 0

// ... perform nesting operations ...

console.log("Final cache size:", cache.getStats()); // e.g., 1247</code></pre>

    <pre class="prettyprint"><code>// Calculate cache hit rate
const initialSize = cache.getStats();
let totalRequests = 0;
let cacheHits = 0;

// During nesting operations
totalRequests++;
if (cache.has(nfpDoc)) {
  cacheHits++;
}

const hitRate = (cacheHits / totalRequests) * 100;
const newEntries = cache.getStats() - initialSize;
console.log(`Hit rate: ${hitRate}%, New entries: ${newEntries}`);</code></pre>



        
            

    

    
    <h4 class="name" id="has"><span class="type-signature"></span>has<span class="signature">(obj)</span><span class="type-signature"> &rarr; {boolean}</span></h4>
    

    
    <p class="summary">Checks if an NFP calculation result exists in the cache.</p>
    



<div class="description">
    <p>Checks if an NFP calculation result exists in the cache.</p>
<p>Fast existence check for cache hit/miss determination without the overhead
of cloning and returning the actual NFP data. Used for cache hit rate
monitoring and conditional computation strategies.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>obj</code></td>
            

            <td class="type">
            
                
<span class="param-type">NfpDoc</span>


            
            </td>

            

            

            <td class="description last"><p>NFP document specifying the calculation to check</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    
    <dt class="tag-since">Since:</dt>
    <dd class="tag-since"><ul class="dummy"><li>1.5.6</li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="build_nfpDb.js.html">build/nfpDb.js</a>, <a href="build_nfpDb.js.html#line276">line 276</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>True if the NFP result is cached, false otherwise</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// Check before expensive calculation
const nfpDoc: NfpDoc = {
  A: "container_1", B: "part_1",
  Arotation: 0, Brotation: 90
};

if (cache.has(nfpDoc)) {
  console.log("Cache hit - using stored result");
  const result = cache.find(nfpDoc);
} else {
  console.log("Cache miss - computing NFP");
  const result = computeExpensiveNfp(nfpDoc);
  cache.insert({ ...nfpDoc, nfp: result });
}</code></pre>



        
            

    

    
    <h4 class="name" id="insert"><span class="type-signature"></span>insert<span class="signature">(obj, inner<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {void}</span></h4>
    

    
    <p class="summary">Stores an NFP calculation result in the cache with deep cloning.</p>
    



<div class="description">
    <p>Stores an NFP calculation result in the cache with deep cloning.</p>
<p>Core cache storage method that saves computed NFP results for future retrieval.
Creates a deep copy of the NFP data to prevent external modifications from
corrupting cached results, ensuring cache integrity throughout the application.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>obj</code></td>
            

            <td class="type">
            
                
<span class="param-type">NfpDoc</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Complete NFP document including calculation result</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>inner</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Whether NFP result is array of NFPs vs single NFP</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    
    <dt class="tag-since">Since:</dt>
    <dd class="tag-since"><ul class="dummy"><li>1.5.6</li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="build_nfpDb.js.html">build/nfpDb.js</a>, <a href="build_nfpDb.js.html#line448">line 448</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li>cloneNfp for cloning implementation details</li>
        
            <li>makeKey for key generation logic</li>
        </ul>
    </dd>
    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">void</span>


    </dd>
</dl>

    




    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// Store single NFP result
const nfpResult = computeNfp(containerPoly, partPoly);
const nfpDoc: NfpDoc = {
  A: "container_1", B: "part_1",
  Arotation: 0, Brotation: 90,
  Aflipped: false, Bflipped: false,
  nfp: nfpResult
};
cache.insert(nfpDoc);</code></pre>

    <pre class="prettyprint"><code>// Store multiple NFP results
const multiNfpResult = computeComplexNfp(complexA, complexB);
const multiNfpDoc: NfpDoc = {
  A: "complex_container", B: "complex_part",
  Arotation: 45, Brotation: 180,
  nfp: multiNfpResult // Array of NFPs
};
cache.insert(multiNfpDoc, true);</code></pre>



        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="DeepNest.html">DeepNest</a></li><li><a href="HullPolygon.html">HullPolygon</a></li><li><a href="NfpCache.html">NfpCache</a></li><li><a href="Point.html">Point</a></li><li><a href="SvgParser.html">SvgParser</a></li><li><a href="Vector.html">Vector</a></li></ul><h3>Global</h3><ul><li><a href="global.html#TOL">TOL</a></li><li><a href="global.html#_almostEqual">_almostEqual</a></li><li><a href="global.html#analyzeParts">analyzeParts</a></li><li><a href="global.html#analyzeSheetHoles">analyzeSheetHoles</a></li><li><a href="global.html#loadPresetList">loadPresetList</a></li><li><a href="global.html#mergedLength">mergedLength</a></li><li><a href="global.html#placeParts">placeParts</a></li><li><a href="global.html#ready">ready</a></li><li><a href="global.html#saveJSON">saveJSON</a></li><li><a href="global.html#updateForm">updateForm</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Jul 10 2025 20:46:29 GMT+0200 (Mitteleuropäische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>